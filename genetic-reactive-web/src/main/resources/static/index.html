<html lang="en">
<body>
<canvas id="container" height="1000" width="1000"></canvas>

<script>
    const multiplier = 15;
    const c = document.getElementById("container");
    const ctx = c.getContext("2d");
    const evtSource = new EventSource("/fluxBoxes");
    evtSource.onmessage = function (event) {
        let packerResponse = JSON.parse(event.data);
        ctx.clearRect(0, 0, c.width, c.height);
        packerResponse.body.boxes.forEach(box => {
            const width = box.rotated ? box.box.depth : box.box.width
            const depth = box.rotated ? box.box.width : box.box.depth
            ctx.fillStyle = "#ff0000"
            ctx.fillRect(box.x * multiplier, box.y * multiplier, width * multiplier, depth * multiplier)
            ctx.beginPath();
            ctx.strokeStyle = "black"
            ctx.rect(box.x * multiplier, box.y * multiplier, width * multiplier, depth * multiplier)
            ctx.stroke();
        })
    }
    evtSource.onerror = e => {
        evtSource.close()
    };
</script>
</body>
</html>